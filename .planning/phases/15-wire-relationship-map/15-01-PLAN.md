---
phase: 15-wire-relationship-map
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: []
autonomous: true

must_haves:
  truths:
    - "User can access relationship visualization from Characters screen"
    - "User can see Relationships tab alongside Character List tab"
    - "Network graph displays with color-coded relationship edges"
  artifacts:
    - path: "gui/index.html"
      provides: "Loads relationship-map.js component via script tag"
      contains: "relationship-map.js"
    - path: "gui/js/components/relationship-map.js"
      provides: "Vis.js network visualization component"
      min_lines: 300
    - path: "gui/js/screens/characters.js"
      provides: "Tabbed interface with Relationships tab"
      contains: "RelationshipMap.render"
  key_links:
    - from: "gui/index.html"
      to: "relationship-map.js component"
      via: "script tag loading"
      pattern: "relationship-map\\.js"
    - from: "characters.js renderRelationshipsTab"
      to: "RelationshipMap.render()"
      via: "component render call with container ID"
      pattern: "RelationshipMap\\.render"
---

<objective>
Verify that RelationshipMap component wiring is complete and functional.

Purpose: Phase 15 was created to address gaps identified in milestone audit v4.1. However, those gaps were subsequently closed by plan 12-03 (executed on 2026-01-17 at 15:01). This plan verifies the current state matches Phase 15 requirements.

Output: Verification that GUI-31 and GUI-32 requirements are satisfied, phase can be marked complete.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Historical context:**
@.planning/v4.1-MILESTONE-AUDIT.md — Milestone audit identified GUI-31/GUI-32 as gaps (created 17:50)
@.planning/phases/12-gui-advanced-features/12-03-SUMMARY.md — Gap closure plan that completed the wiring (executed 15:01)

**Component files:**
@gui/js/components/relationship-map.js — 304-line Vis.js network visualization component
@gui/js/screens/characters.js — Characters screen with tabbed interface
@gui/index.html — Script loading configuration
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify component is loaded in HTML</name>
  <files>gui/index.html</files>
  <action>
    Check that relationship-map.js is loaded via script tag in the components section, after causality-graph.js and before reader-knowledge-tracker.js (as documented in 12-03-SUMMARY.md).

    Expected: `<script src="/js/components/relationship-map.js"></script>` exists in index.html

    Also verify Vis.js library dependencies are loaded (vis-network CSS and JS from CDN).
  </action>
  <verify>grep -c "relationship-map.js" gui/index.html returns 1 (script tag exists)</verify>
  <done>relationship-map.js script tag confirmed in index.html, Vis.js library available</done>
</task>

<task type="auto">
  <name>Task 2: Verify Characters screen integration</name>
  <files>gui/js/screens/characters.js</files>
  <action>
    Verify characters.js has:
    1. Tab navigation with "Relationships" button (data-tab="relationships")
    2. renderTabContent() method with switch case for 'relationships' tab
    3. renderRelationshipsTab() method that calls RelationshipMap.render()
    4. State management using state.get('characterTab')

    Expected pattern matches 12-03-SUMMARY.md implementation.
  </action>
  <verify>
    grep "data-tab=\"relationships\"" gui/js/screens/characters.js confirms tab exists
    grep "RelationshipMap.render" gui/js/screens/characters.js confirms component call
  </verify>
  <done>Characters screen has Relationships tab calling RelationshipMap.render() with currentProjectId</done>
</task>

<task type="auto">
  <name>Task 3: Verify state management</name>
  <files>gui/js/state.js</files>
  <action>
    Check that state.js includes characterTab field for tracking active tab ('list' | 'relationships').

    This was added in 12-03 to match the tab pattern from story-logic.js.
  </action>
  <verify>grep characterTab gui/js/state.js shows field exists in initial state</verify>
  <done>State management configured with characterTab field</done>
</task>

</tasks>

<verification>
All verification can be done via file inspection and grep checks:
- [ ] relationship-map.js script tag exists in gui/index.html
- [ ] Vis.js library loaded in gui/index.html
- [ ] Characters screen has Relationships tab button
- [ ] Characters screen calls RelationshipMap.render()
- [ ] State.js has characterTab field
</verification>

<success_criteria>

- All file checks pass (script tags, tab integration, component calls present)
- Requirements GUI-31 and GUI-32 confirmed satisfied by existing code
- Phase 15 marked complete (work already done by 12-03)
- Documentation updated to note gap closure timeline
  </success_criteria>

<output>
After completion, create `.planning/phases/15-wire-relationship-map/15-01-SUMMARY.md` documenting:
- Verification results showing all requirements satisfied
- Cross-reference to 12-03-SUMMARY.md (actual implementation)
- Timeline: Phase 15 created to address audit gaps → gaps closed by 12-03 → Phase 15 verifies completion
</output>
